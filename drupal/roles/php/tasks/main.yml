---
- name: "Install php extensions"
  apt: name={{ item }} state=present
  with_items:
    - php-gd
    - php-dev
    - php-pear
    - php-mysql
    - php-cli
    - php-date
    - php-ssh2
    - php-xml
    - php-json
    - php-curl
    - php-mbstring

- name: "Get composer installer"
  get_url:
    url: https://getcomposer.org/installer
    dest: /tmp/installer

- name: "Install composer"
  shell: cat /tmp/installer | php -- --install-dir=/usr/local/bin
  args:
    creates: /usr/local/bin/composer

- name: "Replace composer.phar to composer"
  shell: mv /usr/local/bin/composer.phar /usr/local/bin/composer
  args:
    creates: /usr/local/bin/composer

- name: "Make composer executable"
  file: 
    path: /usr/local/bin/composer
    mode: a+x
    state: file
  tags: composer
